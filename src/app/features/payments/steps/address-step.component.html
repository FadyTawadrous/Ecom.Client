<div class="delivery-page">
  <div class="container">

    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title">Select Delivery Address</h1>
        <p class="page-subtitle">Choose where you want your items delivered</p>
      </div>

      <button mat-flat-button (click)="openDialog()" class="add-btn">
        <mat-icon>add_location_alt</mat-icon>
        Add Address
      </button>
    </div>

    @if (addresses().length === 0) {
    <div class="empty-state">
      <div class="icon-circle">
        <mat-icon>location_off</mat-icon>
      </div>
      <h3>No addresses found</h3>
      <p>Please add a delivery address to proceed with your order.</p>
      <button mat-stroked-button (click)="openDialog()" class="empty-add-btn">
        Create Address
      </button>
    </div>
    }

    <div class="address-grid">
      @for (addr of addresses(); track addr.id) {

      <mat-card class="address-card" [class.selected]="selectedAddressId() === addr.id" (click)="chooseAddress(addr)">

        <div class="card-content">
          <div class="address-main">

            <div class="location-header">
              <mat-icon class="city-icon">location_city</mat-icon>
              <div class="location-text">
                <h3 class="city">{{ addr.city }}</h3>
                <span class="country">{{ addr.country }}</span>
              </div>
            </div>

            <div class="street-details">
              <div class="detail-row">
                <div class="icon-box">
                  <mat-icon>home</mat-icon>
                </div>
                <span class="street">{{ addr.street }}</span>
              </div>

              @if (addr.postalCode) {
              <div class="detail-row">
                <div class="icon-box">
                  <mat-icon>markunread_mailbox</mat-icon>
                </div>
                <span class="zip">{{ addr.postalCode }}</span>
              </div>
              }
            </div>

          </div>

          <div class="card-actions">
            <button mat-icon-button class="action-btn" (click)="openDialog(addr); $event.stopPropagation()">
              <mat-icon>edit</mat-icon>
            </button>
          </div>
        </div>

        <div class="card-footer">
          @if (selectedAddressId() === addr.id) {
          <div class="selected-indicator">
            <mat-icon>check_circle</mat-icon>
            <span>Selected</span>
          </div>
          } @else {
          <span class="select-text">Click to select</span>
          }
        </div>

      </mat-card>

      }
    </div>

    <div class="footer-actions">
      <button mat-flat-button class="continue-btn" [disabled]="!selectedAddressId()" (click)="continue()">
        Continue to Payment <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>

  </div>
</div>