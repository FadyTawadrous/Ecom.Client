<div class="order-details-page">
    <div class="container">

        <div class="page-header">
            <h1 class="page-title">Order Details</h1>
            <p class="page-subtitle">View and track your order status</p>
        </div>

        @if (order(); as o) {

        <div class="stepper-wrapper">
            <app-order-status-stepper [status]="o.status"></app-order-status-stepper>
        </div>

        <mat-card class="order-card">
            <div class="card-content">

                <div class="card-header">
                    <div class="header-left">
                        <div class="icon-box">
                            <mat-icon>receipt_long</mat-icon>
                        </div>
                        <div class="title-group">
                            <h2>Order #{{ o.id }}</h2>
                            <span class="date">Placed on {{ o.createdOn | date:'mediumDate' }}</span>
                        </div>
                    </div>

                    <span class="status-badge" [ngClass]="getStatusClass(o.status)">
                        {{ o.status }}
                    </span>
                </div>

                <mat-divider></mat-divider>

                <div class="info-grid">

                    <div class="info-item">
                        <span class="label">Current Status</span>
                        <span class="value">{{ o.status }}</span>
                    </div>

                    <div class="info-item">
                        <span class="label">Tracking Number</span>
                        <span class="value tracking">{{ o.trackingNumber || 'Pending...' }}</span>
                    </div>

                    <div class="info-item">
                        <span class="label">Estimated Delivery</span>
                        <span class="value">{{ o.deliveryDate ? (o.deliveryDate | date:'mediumDate') : 'TBA' }}</span>
                    </div>

                </div>

                <h3 class="section-title">Items</h3>
                <div class="table-container">
                    <table mat-table [dataSource]="o.items" class="items-table">

                        <ng-container matColumnDef="productName">
                            <th mat-header-cell *matHeaderCellDef class="col-product"> Product </th>
                            <td mat-cell *matCellDef="let item" class="col-product font-medium">
                                {{ item.productTitle }}
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="quantity">
                            <th mat-header-cell *matHeaderCellDef class="col-qty"> Qty </th>
                            <td mat-cell *matCellDef="let item" class="col-qty">
                                x{{ item.quantity }}
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="totalPrice">
                            <th mat-header-cell *matHeaderCellDef class="col-total"> Total </th>
                            <td mat-cell *matCellDef="let item" class="col-total">
                                {{ item.totalPrice | currency }}
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="columns"></tr>
                        <tr mat-row *matRowDef="let row; columns: columns"></tr>
                    </table>
                </div>

                <div class="order-footer">
                    <div class="total-summary">
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span>{{ o.totalAmount | currency }}</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping</span>
                            <span class="free">Free</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total</span>
                            <span class="amount">{{ o.totalAmount | currency }}</span>
                        </div>
                    </div>
                </div>

            </div>
        </mat-card>
        }
    </div>
</div>